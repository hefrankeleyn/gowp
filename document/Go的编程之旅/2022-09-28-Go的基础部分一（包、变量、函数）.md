# Go的基础部分一：包、变量、函数

[toc]

## 一、包

每个Go程序都是由包组成。

程序开始在`main`包中运行。

这个程序使用了导入包"fmt"和"math/rand"

根据惯例，包的名称要和导入路径最后一个元素相同。例如，"math/rand"包，包含了以`package rand`语句开始的文件。

## 二、imports

导入的写法：

```go
import (
  "fmt"
  "math"
)
```

也可以写成多个导入语法：

```go
import "fmt"
import "math"
```

## 三、导出的名称

在Go中，一个名字是被导出的，如果它以大写字母开头。例如，`Pizza`是一个导出名称，称之为`Pi`，它是从`math`包中导出的。

`pizza`和 `pi`不是以大写字母开头，因此它们没有被导出。

当导入一个包，你仅能引用它导出的名字。任何未导出的名字是不能在外面的包访问。

## 四、函数

一个函数能够获取零个或多个参数。

[Go的声明语法](./2022-09-29-Go的声明语法.md)

当两个或多个连续命名的函数参数共享一个类型，你能忽略除了最后一个的所有类型：

```go
func add(x, y int) int {
	return x + y
}
```

在这个例子中，我们缩写：

```
x int, y
```

成为：

```
x, y int
```

## 五、多个结果

一个函数能够返回任意数量的结果。

```go
func swap(x, y string) (string, string) {
	return x, y
}
```

这个`swap`函数返回两个字符串

## 六、对返回结果进行命令

Go的返回值可能被命名。如果这样，它们将被作为变量定义在函数的顶部。

这些名称应该用于记录返回值的含义。

一个不带参数的`return`陈述返回命名的返回值，被称为裸返回。

```go
func split(sum int) (x, y int) {
	x = sum * 4 / 9
	y = sum - x
	return
}
```

裸返回阐述应用只用于短函数中，正如例子展示的。在长函数中它很难读。

## 七、变量

`var` 语句声明了一列变量；就像函数的参数列表，类型是最后一个。

一个`var`变量能够在包或函数层级。我们能在例子中看到两者。

```go
package main

import "fmt"

var c, java, python bool

func main() {
	var i int
	fmt.Println(i, c, java, python)
}

```

## 八、带有初始化值的变量

一个`var`声明能够包含初始化值，每个变量一个。

如果初始化器存在，就可以忽略类型；变量将获取初始化器的类型。

```go
package main

import "fmt"

var i, j int = 1, 2

func main() {
	var c1, python1, java1 = true, false, "no"
	fmt.Println(i, j, c1, python1, java1)
}

```

## 九、简化变量的声明

在函数的内部，可以使用`:=`简化赋值语句来替换隐含类型的`var`声明。

在函数的外部，每个语句都以关键词（`var`、`function`等等）开头，因此`:=`结构不可用。

```go
func main() {
	var i, j int = 1, 2
	k := 3
	c, python, java := true, false, "no!"
	fmt.Println(i, j, k, c, python, java)
}
```

## 十、基础类型

Go的基础类型是：

```
bool

string

int  int8  int16  int32  int64

uint uint8 uint16 uint32 uint64 uintptr

byte // uint8 的别名

rune // int32 的别名 
     // 代表 一个 Unicode编码点
     
float32 float64 

complex64 complex128
```

下面的例子中展示了若干个类型的变量，并且变量的声明可以组织到块中，就像import声明一样。

```go
package main

import (
	"fmt"
	"math/cmplx"
)

var (
	ToBe   bool       = false
	MaxInt uint64     = 1<<64 - 1
	z      complex128 = cmplx.Sqrt(-5 + 12i)
)

func main() {
	fmt.Printf("Type: %T Value: %v\n", ToBe, ToBe)
	fmt.Printf("Type: %T Value: %v\n", MaxInt, MaxInt)
	fmt.Printf("Type: %T Value: %v\n", z, z)
}

```

`int`、`uint`和`uintptr`通常在32位机器上是32位宽，在64位机器上是64位宽。当你需要一个整数值你应该使用int，除非你有一个特殊的原因去使用大小或无符号的整数值。

## 十一、零值

变量声明不带一个明确的初始值，将给一个0值。

是零值的类型是：

- 对于数值类型是0；
- 对于bool类型是false；
- 对于字符串是空字符串""；

```go
package main

import "fmt"

func main() {
	var i int
	var f float64
	var b bool
	var s string
	fmt.Printf("%v, %v, %v, %q\n", i, f, b, s)
}

```

## 十二、类型转化

表达式`T(v)`将值v转化为T类型。

一些数值转换：

```go
var i int = 42
var f float64 = float64(i)
var u uint  = uint(f)
```

或者，更简单的说：
```go
i := 42
f := float64(i)
u := uint(f)
```

不像在C中，在Go中的不同类型项目间的赋值需要一个明确的转换。在例子中试着移除类型转换用的`float64`或`uint`看看会发生什么。

> 不明确类型转换，会报错。

## 十三、类型推断

当声明一个不带明确类型变量的时候（既可以通过使用`:=`语法，也可以通过使用`var = `表达式语法），变量的类型是通过右手边的值进行推断。

当右手边的值声明了类型，新的变量就拥有相同的类型。

```go
var i int
j := i   // j 是 int类型
```

但是当右手边包含一个没有类型的数值常量，新的变量可能是`int`、`float64`、或`complex128`，取决于常量的精度。

```go
i := 42   // int 
f := 3.142  // float64
g := 0.857 + 0.5i // complex128
```

试着改变案例中代码的`v`的初始化值，并观察类型是如何受影响。

```go
package main

import "fmt"

func main() {
	var v = 64i
	fmt.Printf("v is of Type %T\n", v)
}
```

## 十四、常数

常用被声明得像变量，但是带有`const`关键字。

常量可以是字符、字符串、boolean、或数值类型。

常量不能使用`:=`语法被声明。

```go
package main

import "fmt"

const Pi = 3.14

func main() {
	const World = "世界"
	fmt.Println("Hello", World)
	fmt.Println("Happy", Pi, "Day")

	const Truth = true
	fmt.Println("Go rules?", Truth)
}
```

## 十五、数值常量

数值常量是高精确的值。

一个无类型常量采用其上下文所需的类型。

也试着打印`needInt(Big)`。

（int 最多可以存储 64 位整数，有时更少）

```go
package main

import "fmt"

const (
	// 通过把1字节向左移动100位，创建一个大数
	// 换句话说，这个二进制数是1后面跟100个0
	Big = 1 << 100
	// 再次将它向右移动99位，因此，我们最终得到 1<<1  或者 2
	Small = Big >> 99
)

func needInt(x int) int {
	return x*10 + 1
}

func needFloat(x float64) float64 {
	return x * 0.1
}

func main() {
	fmt.Println(needInt(Small))
	fmt.Println(needFloat(Small))
	fmt.Println(needFloat(Big))
	// 会报错
	fmt.Println(needInt(Big))
}

```



